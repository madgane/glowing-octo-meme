
The distributed solutions via primal and \ac{ADMM} approaches depend on the subgradient update by using a step size parameter for the coupling variables, which affects the speed of convergence to the optimal value. In this method, we provide an alternative approach to decentralize the \ac{MSE} equivalent problem considered in \cite{christensen2008weighted,wmmse_shi} by solving the \ac{KKT} conditions. Similar work has been considered for the \ac{WSRM} problem with the minimum rate constraints in \cite{kaleva2013decentralized,kaleva2013primal}. When the queues are involved, the maximum rate constraint imposed by the number of queued packets at the \ac{BS} includes a nonconvex constraint, which makes the problem difficult to solve due to the additional nonconvex maximum rate constraint \eqref{eqn-3.1.4} for the \ac{WSRM} problem.

Even though the rate constraints are implicitly present in the objective function, we cannot formulate the \ac{KKT} conditions readily due to the non-differentiable objective function. The non-differentiability of the objective function is due to the absolute operator present in the norm function. In order to make the objective function differentiable, we consider the following case for which the absolute operator can be ignored without affecting the optimal solution, namely,
\begin{itemize}
\item when the exponent \me{q} is even or,
\item when the number of backlogged packets of each user is large enough, \textit{i.e}, \me{Q_k \gg \sum_{n=1}^N \sum_{l=1}^L {t}_{l,k,n}} to ignore the absolute operator and the queues as well.
\end{itemize}

With the assumption of either one of the above conditions to be true, the problem in \eqref{eqn-mse-2} can be written as
\begin{IEEEeqnarray}{rCl}\label{kkt-mse-1}
\underset{\substack{t_{l,k,n},\mvec{M}{k,n}, \\ \epsilon_{l,k,n}, \mvec{W}{k,n}}}{\text{minimize}} &\hspace{0.5cm}& \sum_{b \in \mc{B}} \sum_{k \in \mc{U}_b} \, a_k \, \Big ( Q_k - \sum_{n = 1}^N \sum_{l = 1}^{L} t_{l,k,n} \Big )^q \IEEEyessubnumber \label{kkt-mse-1.1} \\
\text{subject to} & \hspace{0.5cm} & \nonumber \\
\alpha_{l,k,n} : & \hspace{0.5cm} & \left | 1 - \mvec{w}{l,k,n}^\herm \mvec{H}{b_k,k,n} \mvec{m}{l,k,n} \right |^2 +  N_0 \, \|\mvec{w}{l,k,n}\|^2 \nonumber \\
&\hspace{0.5cm}& \qquad {} \qquad {} + \sum_{\mathclap{(x,y) \neq (l,k)}} \left | \mvec{w}{l,k,n}^\herm \mvec{H}{b_y,y,n} \mvec{m}{x,y,n} \right |^2 \leq \epsilon_{l,k,n} \IEEEyessubnumber \label{kkt-mse-1.2} \\
\sigma_{l,k,n} : & \hspace{0.5cm} & - \log(\tilde{\epsilon}_{l,k,n}) - \frac{\left ( {\epsilon}_{l,k,n} - \tilde{\epsilon}_{l,k,n} \right ) }{\tilde{\epsilon}_{l,k,n}} \geq t_{l,k,n} \, \log(2) \IEEEyessubnumber \label{kkt-mse-1.3} \\
\delta_b : & \hspace{0.5cm} & \sum_{n = 1}^N \sum_{k \in \mathcal{U}_b} \sum_{l = 1}^L \text{tr} \, (\mvec{m}{l,k,n} \mvec{m}{l,k,n}^\herm) \leq P_{{\max}}, \fall b \IEEEyessubnumber \label{kkt-mse-1.4}
\end{IEEEeqnarray}
where \me{\alpha_{l,k,n},\sigma_{l,k,n}} and \me{\delta_b} are the dual variables corresponding to the constraints defined in \eqref{kkt-mse-1.2}, \eqref{kkt-mse-1.3} and \eqref{kkt-mse-1.4}. 

By forming the Lagrangian of \eqref{kkt-mse-1} with the corresponding dual variables as shown in \eqref{kkt-mse-1}, we can obtain the \ac{KKT} expressions by differentiating with respect to the variables present in the problem as detailed in Appendix \ref{a-1}. Upon solving the \ac{KKT} expressions, the iterative solution \me{\forall k \in \mc{U}}, \me{\forall n \in \set{1,\ldots,N}} and \me{\forall l \in \set{1,\ldots,L}} is given by
\begin{IEEEeqnarray}{rCl} \label{kkt-mse-4}
\mvec{m}{l,k,n}^{(i)} &=& \Big ( \sum_{x \in \mc{U}} \sum_{y=1}^L \alpha_{y,x,n}^{(i-1)} \mvec{H}{b_k,x,n}^\herm \mvec{w}{y,x,n}^{(i-1)} \mvec{w}{y,x,n}^{\herm \, {(i-1)}} \mvec{H}{b_k,x,n} + \delta_b \mbf{I}_{N_T} \Big )^{-1} \alpha^{(i-1)}_{l,k,n} \mvec{H}{b_k,k,n}^\herm \mvec{w}{l,k,n}^{(i-1)} \IEEEyessubnumber \label{kkt-mse-4.3} \\
\epsilon_{l,k,n}^{(i)} &=& \left | 1 - \mvec{w}{l,k,n}^{\herm \, (i)} \mvec{H}{b_k,k,n} \mvec{m}{l,k,n}^{(i)} \right |^2 + \sum_{\mathclap{(x,y) \neq (l,k)}} \left | \mvec{w}{l,k,n}^{\mathrm{H} \, (i)} \mvec{H}{b_y,y,n} \mvec{m}{x,y,n}^{(i)} \right |^2 + N_0 \, \|\mvec{w}{l,k,n}^{(i)}\|^2 \IEEEyessubnumber \label{kkt-mse-4.4} \\
t_{l,k,n}^{(i)} &=&  -\log_2(\epsilon_{l,k,n}^{(i-1)}) - \frac{\left ( \epsilon_{l,k,n}^{(i)} - \epsilon_{l,k,n}^{(i-1)} \right ) }{\log(2) \, \epsilon_{l,k,n}^{(i-1)}} \IEEEyessubnumber \label{kkt-mse-4.5} \\
\sigma_{l,k,n}^{(i)} &=& \max{\left (0, \frac{a_k \, q}{\log(2)}  \, \Big (Q_k - \sum_{n = 1}^N \sum_{l=1}^L t_{l,k,n}^{(i)} \Big )^{(q-1)}\right )}  \IEEEyessubnumber \label{kkt-mse-4.2} \\
\alpha^{(i)}_{l,k,n} &=& \alpha^{(i-1)}_{l,k,n} + \rho \left ( \dfrac{\sigma_{l,k,n}^{(i)}}{\epsilon_{l,k,n}^{(i)}} - \alpha^{(i-1)}_{l,k,n} \right ) \IEEEyessubnumber \label{kkt-mse-4.1} \\
\mvec{w}{l,k,n}^{(i)} &=& \Big ( \sum_{x\in\mc{U}}\sum_{y=1}^L \mvec{H}{b_x,k,n} \mvec{m}{y,x,n}^{(i)} \mvec{m}{y,x,n}^{\herm \, (i)} \mvec{H}{b_{x},k,n}^\herm + \mathbf{I}_{N_R} \Big ) ^{-1} \; \mvec{H}{b_k,k,n} \; \mvec{m}{l,k,n}^{(i)} \IEEEyessubnumber \label{kkt-mse-4.6}
\end{IEEEeqnarray}
Since the dual variables \me{\alpha^{(i)}} and \me{\sigma^{(i)}} are interdependent in \eqref{kkt-mse-4}, one has to be fixed to optimize for the other. In this problem, we fix the dual variable \me{\alpha^{(i)}} to a fixed value as in \eqref{kkt-mse-4.1} to obtain the other variables in \eqref{kkt-mse-4}. It can be seen that, when the allocated rate \me{t_k^{(i-1)}} is greater than the number of queued packets \me{Q_k} for a user \me{k}, the corresponding dual variable \me{\sigma^{(i)}} will be negative thereby forcing the dual variable \me{\alpha_k^{(i)} < \alpha_k^{(i-1)}}, which in turn reduce the transmit precoder weights in \eqref{kkt-mse-4.3}. This reduction in the precoder weights forces the allocated rate of the user \me{k} to reduce from the previous iteration as \me{t_k^{(i)} < t_k^{(i-1)}}.

The \ac{KKT} solutions provided in \eqref{kkt-mse-4} are solved in an iterative manner by initializing the transmit and the receive precoders \me{\mvec{M}{k,n},\mvec{W}{k,n}} with the single user beamforming and the \ac{MMSE} vectors. The dual variable \me{\alpha}'s corresponding to precoder weights are initialized with ones to provide equal priorities to all streams. Now, the closed form expressions in \eqref{kkt-mse-4} are evaluated sequentially until convergence or to a certain accuracy. In \eqref{kkt-mse-4}, all expressions are in closed form except the transmit precoders \eqref{kkt-mse-4.3}, which depends on the \ac{BS} specific dual variable \me{\delta_b}. It can be solved efficiently by the bisection method satisfying the power constraint \eqref{kkt-mse-1.4}. After each iteration instant, the transmit and the receive precoders are updated across the coordinating \acp{BS} in \me{\mc{B}} to obtain the next operating point.

In order to perform the distributed approach, we can consider the method proposed in \cite{komulainen2013effective}, where the users evaluate the \ac{MSE}, and the dual variable \me{\alpha_{l,k,n}} using the transmission made by all \acp{BS} using the updated transmit precoders \me{\mvec{m}{l,k,n}^{(i-1)}}. Once the dual variables are evaluated, the users will notify the dual variables and the receive beamformers to the \acp{BS} using uplink precoded pilots, where the uplink precoder is given by \me{\mvec{\tilde{w}}{l,k,n}^{(i-1)} = \sqrt{\alpha_{l,k,n}^{(i-1)}}\mvec{w}{l,k,n}^{\ast(i-1)}}. Upon receiving the uplink precoded pilots at the \ac{BS} \me{b}, the effective channel \me{\mvec{H}{b,k,n}^{\mathrm{T}} \mvec{\tilde{w}}{l,k,n}^{(i-1)}} can be measured and used in the expression \eqref{kkt-mse-4.3} to update the transmit precoders, where \me{\mbf{x}^{\ast}} represents the conjugate of \me{\mbf{x}}. The algorithmic representation of the distributed \ac{MSE}-\ac{KKT} scheme is shown in the Algorithm. \ref{algo-4}.
\begin{algorithm}
 \SetAlgoLined
 \DontPrintSemicolon
 \BlankLine
 \SetKwInput{KwInit}{Initialize}
 \KwIn{\me{a_k, \, Q_k, \, \mvec{H}{b,k,n},\; \fall b \in \mathcal{B}, \, \fall k \in \mathcal{U}, \fall n \in \mathcal{N}}}
 \KwOut{\me{\mvec{m}{l,k,n}} and \me{\mvec{w}{l,k,n} \fall l \in \set{1,2,\dotsc,L}}}
 \KwInit{\me{i=1} and the receive beamformers \me{\mbf{w}^{(0)}_{l,k,n}} randomly}
 \KwInit{\me{\epsilon_{l,k,n}^{(0)}} randomly and the dual variables \me{{\alpha}_{l,k,n}^{(0)} = 1}}
 for each \ac{BS} \me{b \in \mc{B}}, perform the following procedure \;
 set the maximum iteration counter \me{I_{\max},J_{\max}} to a valid number. \;
 initialize \me{j = 0}. \;
 \Repeat{until convergence or \me{j \geq J_{\max}}}{
 initialize \me{i = 0}. \;
 \Repeat{until convergence or \me{i \geq I_{\max}}}{
	update the transmit precoders \me{\mvec{M}{k,n}^{(i)}} using \eqref{kkt-mse-4.3}, where \me{\delta_b} is identified by the bisection method satisfying \eqref{kkt-mse-1.4}. \;
    update \me{\epsilon_{l,k,n}^{(i)}}, \me{t_{l,k,n}^{(i)}}, \me{\sigma_{l,k,n}^{(i)}} and \me{\alpha_{l,k,n}^{(i)}} using \eqref{kkt-mse-4.4} and \eqref{kkt-mse-4.5}, \eqref{kkt-mse-4.2} and \eqref{kkt-mse-4.1} at the receivers using the transmit precoders \me{\mvec{M}{k,n}^{(i)}} from all \acp{BS}. \;
    perform precoded uplink pilot transmission from all users with the precoder \me{\mvec{\tilde{w}}{l,k,n}^{(j)}}. \;
    \me{i = i + 1} \;
  }
 evaluate the receive beamforming vector \me{\mvec{W}{k,n}^{(j+1)}} using \eqref{kkt-mse-4.6}. \;
 inform \acp{BS} using uplink precoded pilot transmission from all users with the precoder \me{\mvec{\tilde{w}}{l,k,n}^{(j+1)}}. \;
 \me{j = j + 1}. \;
 }
 \caption{\ac{KKT} approach for the \ac{JSFRA} scheme}
 \label{algo-4}
\end{algorithm}

\subsubsection*{Convergence}
The iterative method presented in Algorithm \ref{algo-4} converges to the stationary point if the dual variables \me{\alpha_{l,k,n}} are allowed to converge. The convergence of the dual variable is guaranteed, since the problem is convex by fixing the receive precoders \me{\mvec{w}{l,k,n}} and the operating \ac{MSE} point \me{\epsilon_{l,k,n}} \cite{boyd2011distributed}. Once the dual variables are converged or iterated to a certain accuracy, the receivers are updated using the \ac{MMSE} objective. In this algorithm, when \me{t_k > Q_k}, \me{\sigma_{l,k,n}} will be zero (dual feasibility), thereby reducing the priority weights \me{\alpha_{l,k,n}} present in the transmit precoder expression in \eqref{kkt-mse-4.3}.
