We consider a downlink \ac{MIMO} \ac{IBC} scenario in an \ac{OFDM} framework with \me{N} sub-channels and \me{N_B} \acp{BS} each equipped with \me{N_T} transmit antennas, serving in total \me{K} users each with \me{N_R} receive antennas. The set of users associated with \ac{BS} \me{b} is denoted by \me{\mathcal{U}_b} and the set \me{\mathcal{U}} represents all users in the system, i.e., \me{\mathcal{U} =\underset{b\in \mathcal{B}}{\cup }\mathcal{U}_b}, where \me{\mathcal{B}} is the set of indices of all coordinating \acp{BS}. Data for user \me{k} is transmitted from only one \ac{BS} which is denoted by \me{b_k\in \mathcal{B}}. Let \me{\mathcal{N} = \set{1,2,\dotsc,N}} be the set of all sub-channel indices available in the system. 

We adopt linear transmit beamforming technique at \acp{BS}. Specifically, the data symbols \me{d_{l,k,n}} for  user \me{k} on the \me{l^\mathrm{th}} spatial stream over sub-channel \me{n} is multiplied with beamformer \me{\mvec{m}{l,k,n} \in \mathbb{C}^{N_T \times 1}} before being transmitted. In order to detect  multiple spatial streams at the user terminal, receive beamforming vector \me{\mvec{w}{l,k,n}} is employed for each user. Consequently, the received data estimate corresponding to the \me{l^\mathrm{th}} spatial stream over sub-channel \me{n} at user $k$ is given by
\iftoggle{single_column}{
\begin{equation}\label{eqn-1}
\hat{d}_{l,k,n} = \mvec{w}{l,k,n}^\herm \mvec{H}{b_k,k,n} \,\mvec{m}{l,k,n} d_{l,k,n} + \mvec{w}{l,k,n}^\herm \sum_{i \in \mc{U} \backslash \set{k}} \mvec{H}{b_i,k,n} \sum_{j = 1}^L \mvec{m}{j,i,n}d_{j,i,n} + \mvec{w}{l,k,n}^\herm \mvec{n}{k,n}
\end{equation}
}{
\begin{multline}\label{eqn-1}
\hat{d}_{l,k,n} = \mvec{w}{l,k,n}^\herm \mvec{H}{b_k,k,n} \,\mvec{m}{l,k,n} d_{l,k,n} + \mvec{w}{l,k,n}^\herm \mvec{n}{k,n} \\ 
+ \mvec{w}{l,k,n}^\herm \sum_{i \in \mc{U} \backslash \set{k}} \mvec{H}{b_i,k,n} \sum_{j = 1}^L \mvec{m}{j,i,n}d_{j,i,n}
\end{multline}
}
where \me{\mvec{H}{b,k,n} \in \mathbb{C}^{N_R \times N_T}} is the channel between \ac{BS} \me{b} and  user \me{k} on sub-channel \me{n}, and \me{\mvec{n}{k,n}} \me{\sim \mc{CN}(0,N_0)} is the additive noise vector for user \me{k} on the \me{n^\mathrm{th}} sub-channel and \me{l^\mathrm{th}} spatial stream. In \eqref{eqn-1}, \me{L = \text{rank}(\mvec{H}{b,k,n}) = \min(N_T,N_R)} is the maximum number of spatial streams.\footnote{It can be easily extended for user specific streams \me{L_k} instead of using common \me{L} streams for all users. \me{L} streams are initialized but after solving the problem, only \me{L_{k,n} \leq L} non-zero data streams are transmitted.} Assuming independent detection of data streams, we can write the signal-to-interference-plus-noise ratio (SINR) as
\begin{equation}\label{eq:SINR}
\gamma_{l,k,n} = \dfrac{\left |\mvec{w}{l,k,n}^\herm \, \mvec{H}{b_k,k,n} \, \mvec{m}{l,k,n} \right |^2}{\enoise + \sum_{(j,i) \neq (l,k)} |\mvec{w}{l,k,n}^\herm \mvec{H}{b_i,k,n} \mvec{m}{j,i,n} |^2}
\end{equation}
where \me{\enoise = N_0 \, \trace (\mvec{w}{l,k,n} \mbf{w}_{l,k,n}^\herm)} denotes the equivalent noise variance. \review{To reduce the overhead involved in feeding back the user channels, we consider a \ac{TDD} system in which \acp{BS} can estimate the downlink channels from the uplink pilots using channel reciprocity.}

Let \me{Q_k} be the number of backlogged packets destined for user \me{k} at a given scheduling instant. The queue dynamics of user \me{k} are modeled using the Poisson arrival process with the average number of packet arrivals of \me{A_k = \mathbf{E}_i\{\lambda_k\}} packets/bits, where \me{\lambda_k(i) \sim \mathrm{Pois}(A_k)} represents the instantaneous number of packets arriving for user \me{k} at the \me{{i}^\mathrm{th}} time instant.\footnote{The unit can either be packets or bits as long as the arrival and the transmission units are similar.} The total number of queued packets at the \me{{(i+1)}^\mathrm{th}} instant for user \me{k}, denoted as \me{Q_k(i+1)}, is given by
\begin{equation}
Q_k(i+1) = \Big [ Q_k(i) - t_k(i) \Big ]^+ + \lambda_k(i)
\label{eqn-2a}
\end{equation}
where \me{[x]^+ \equiv \max{ \lbrace x,0  \rbrace}} and \me{t_k} denotes the number of transmitted packets or bits for user \me{k}. At the \me{\ith{i}} instant, the transmission rate of user \me{k} is given by
\begin{equation}
t_k(i) = \sum_{n = 1}^N \, \sum_{l = 1}^L \, t_{l,k,n}(i)
\end{equation}
where \me{t_{l,k,n}} denotes the number of transmitted packets or bits over the \me{\ith{l}} spatial stream on the \me{\ith{n}} sub-channel. The maximum rate achieved over the space-frequency resource \me{(l,n)} is given by \me{t_{l,k,n} \leq \log_2(1 + \gamma_{l,k,n})} for the \ac{SINR} \me{\gamma_{l,k,n}}.\footnote{The upper bound can be achieved by using Gaussian signaling.} The units of \me{t_k} and \me{Q_k} are in bits defined per channel use. 